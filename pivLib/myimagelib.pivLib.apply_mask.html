<!DOCTYPE html>
<html >
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1"><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

      <title>myimagelib.pivLib.apply_mask</title>
    
          <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
          <link rel="stylesheet" href="../_static/theme.css " type="text/css" />
      
      <!-- sphinx script_files -->
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>

      
      <!-- bundled in js (rollup iife) -->
      <!-- <script src="../_static/theme-vendors.js"></script> -->
      <script src="../_static/theme.js" defer></script>
    
  <link rel="index" title="Index" href="../genindex.html" />
  <link rel="search" title="Search" href="../search.html" />
  <link rel="next" title="myimagelib.pivLib.piv_data" href="myimagelib.pivLib.piv_data.html" />
  <link rel="prev" title="myimagelib.pivLib.tangent_unit" href="myimagelib.pivLib.tangent_unit.html" /> 
  </head>

  <body>
    <div id="app">
    <div class="theme-container" :class="pageClasses"><navbar @toggle-sidebar="toggleSidebar">
  <router-link to="../index.html" class="home-link">
    
      <span class="site-name">myimagelib</span>
    
  </router-link>

  <div class="links">
    <navlinks class="can-hide">



    </navlinks>
  </div>
</navbar>

      
      <div class="sidebar-mask" @click="toggleSidebar(false)">
      </div>
        <sidebar @toggle-sidebar="toggleSidebar">
          
          <navlinks>
            



            
          </navlinks><div id="searchbox" class="searchbox" role="search">
  <div class="caption"><span class="caption-text">Quick search</span>
    <div class="searchformwrapper">
      <form class="search" action="../search.html" method="get">
        <input type="text" name="q" />
        <input type="submit" value="Search" />
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
      </form>
    </div>
  </div>
</div><div class="sidebar-links" role="navigation" aria-label="main navigation">
  
    <div class="sidebar-group">
      <p class="caption">
        <span class="caption-text"><a href="../index.html#contents">contents</a></span>
      </p>
      <ul class="">
        
          <li class="toctree-l1 ">
            
              <a href="../usage.html" class="reference internal ">Usage</a>
            

            
          </li>

        
          <li class="toctree-l1 ">
            
              <a href="../myImageLib.html" class="reference internal ">myImageLib</a>
            

            
          </li>

        
          <li class="toctree-l1 ">
            
              <a href="../corrLib.html" class="reference internal ">corrLib</a>
            

            
          </li>

        
          <li class="toctree-l1 ">
            
              <a href="../pivLib.html" class="reference internal ">pivLib</a>
            

            
          </li>

        
      </ul>
    </div>
  
</div>
        </sidebar>

      <page>
          <div class="body-header" role="navigation" aria-label="navigation">
  
  <ul class="breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
    
      <li><a href="../pivLib.html">pivLib</a> &raquo;</li>
    
    <li>myimagelib.pivLib.apply_mask</li>
  </ul>
  

  <ul class="page-nav">
  <li class="prev">
    <a href="myimagelib.pivLib.tangent_unit.html"
       title="previous chapter">← myimagelib.pivLib.tangent_unit</a>
  </li>
  <li class="next">
    <a href="myimagelib.pivLib.piv_data.html"
       title="next chapter">myimagelib.pivLib.piv_data →</a>
  </li>
</ul>
  
</div>
<hr>
          <div class="content" role="main" v-pre>
            
  <section id="myimagelib-pivlib-apply-mask">
<h1>myimagelib.pivLib.apply_mask<a class="headerlink" href="#myimagelib-pivlib-apply-mask" title="Permalink to this headline">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="myimagelib.pivLib.apply_mask">
<span class="sig-prename descclassname"><span class="pre">myimagelib.pivLib.</span></span><span class="sig-name descname"><span class="pre">apply_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pivData</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#myimagelib.pivLib.apply_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply a mask on PIV data, by adding a boolean column “mask” to the original x, y, u, v data file. Valid velocities are labeled <code class="docutils literal notranslate"><span class="pre">True</span></code> while invalid velocities are labeled <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pivData</strong> (<em>pandas.DataFrame</em>) – PIV data (x, y, u, v)</p></li>
<li><p><strong>mask</strong> (<em>2D array</em>) – an image, preferrably binary, where large value denotes valid data and small value denote invalid data. The image will be converted to a boolean array by <code class="docutils literal notranslate"><span class="pre">mask</span> <span class="pre">=</span> <span class="pre">mask</span> <span class="pre">&gt;</span> <span class="pre">mask.mean()</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>masked PIV data.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
<p class="rubric">Test</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pivData</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;test_files/piv-test.csv&quot;</span><span class="p">)</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s2">&quot;test_files/mask.tif&quot;</span><span class="p">)</span>
<span class="n">mpiv</span> <span class="o">=</span> <span class="n">apply_mask</span><span class="p">(</span><span class="n">pivData</span><span class="p">,</span> <span class="n">mask</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">pivData</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">pivData</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">pivData</span><span class="o">.</span><span class="n">u</span><span class="p">,</span> <span class="n">pivData</span><span class="o">.</span><span class="n">v</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">quiver</span><span class="p">(</span><span class="n">mpiv</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">mpiv</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">mpiv</span><span class="o">.</span><span class="n">u</span><span class="p">,</span> <span class="n">mpiv</span><span class="o">.</span><span class="n">v</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Edit</p>
<ul class="simple">
<li><p>Nov 17, 2022 – Initial commit.</p></li>
<li><p>Nov 30, 2022 – Instead of replacing invalid data with <code class="docutils literal notranslate"><span class="pre">np.nan</span></code>, add an additional column, where the validity of data is specified.</p></li>
<li><p>Dec 01, 2022 – Remove the erosion step, since it is very obsecure to include this step here. If we want the mask to be more conservative (include less region to be sure that we are free from boundary effect), we can modify the mask in ImageJ and apply again on the PIV data.</p></li>
<li><p>Dec 19, 2022 – Modify docstring to be consistent with code action.</p></li>
</ul>
</dd></dl>

</section>


          </div>
          <div class="page-nav">
            <div class="inner"><ul class="page-nav">
  <li class="prev">
    <a href="myimagelib.pivLib.tangent_unit.html"
       title="previous chapter">← myimagelib.pivLib.tangent_unit</a>
  </li>
  <li class="next">
    <a href="myimagelib.pivLib.piv_data.html"
       title="next chapter">myimagelib.pivLib.piv_data →</a>
  </li>
</ul><div class="footer" role="contentinfo">
      &#169; Copyright 2022-2023, Zhengyang Liu.
    <br>
    Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.5.0 with <a href="https://github.com/schettino72/sphinx_press_theme">Press Theme</a> 0.8.0.
</div>
            </div>
          </div>
      </page>
    </div></div>
    
    
  </body>
</html>