

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>myimagelib.compact_PIV &mdash; myimagelib 1.5 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=aaadad1f"></script>
      <script src="../_static/doctools.js?v=9a2dae69"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            myimagelib
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">myimagelib</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">myimagelib.compact_PIV</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/generated/myimagelib.compact_PIV.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="myimagelib-compact-piv">
<h1>myimagelib.compact_PIV<a class="headerlink" href="#myimagelib-compact-piv" title="Link to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="myimagelib.compact_PIV">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">myimagelib.</span></span><span class="sig-name descname"><span class="pre">compact_PIV</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#myimagelib.compact_PIV" title="Link to this definition"></a></dt>
<dd><p>Compact PIV data structure. Instead of saving PIV data of each frame pair in separated text files, we can save them in a more compact form, where (x, y, mask) information are only saved once and only velocity informations are kept in 3D arrays. The data will be saved in a Matlab style .mat file, and the internal structure is a Python dictionary, with entries (x, y, labels, u, v, mask). Since here x, y, u, v are no longer the same shape, accessing PIV data from a specific frame becomes less straight forward. For example, when doing a quiver plot, one needs to call <code class="docutils literal notranslate"><span class="pre">quiver(x,</span> <span class="pre">y,</span> <span class="pre">u[0],</span> <span class="pre">v[0]</span></code>, instead of <code class="docutils literal notranslate"><span class="pre">quiver(x,</span> <span class="pre">y,</span> <span class="pre">u,</span> <span class="pre">v]</span></code>. This class is written to enable straightforward data access and saving. For a more detailed guide of using this class, see <a class="reference external" href="https://github.com/ZLoverty/mylib/blob/main/tests/compact_PIV.ipynb">compact_PIV tutorial</a>. You can also download the notebook to run the code locally. Note that it requires you to download <a class="reference external" href="https://zloverty.github.io/mylib/usage.html">myimagelib package</a>.</p>
<p class="rubric">Syntax</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">myimagelib</span><span class="w"> </span><span class="kn">import</span> <span class="n">readdata</span><span class="p">,</span> <span class="n">compact_PIV</span>

<span class="c1"># construct compact_PIV object from a folder containing PIV data</span>
<span class="n">folder</span> <span class="o">=</span> <span class="s2">&quot;path/to/piv/data&quot;</span> <span class="c1"># folder containing .csv files</span>
<span class="n">l</span> <span class="o">=</span> <span class="n">readdata</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="s2">&quot;csv&quot;</span><span class="p">)</span>
<span class="n">cpiv</span> <span class="o">=</span> <span class="n">compact_PIV</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>

<span class="c1"># get the data for one frame</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">cpiv</span><span class="o">.</span><span class="n">get_frame</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># save the data to a .mat file</span>
<span class="n">cpiv</span><span class="o">.</span><span class="n">to_mat</span><span class="p">(</span><span class="s2">&quot;cpiv.mat&quot;</span><span class="p">)</span>

<span class="c1"># Update mask</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">skimage.io</span><span class="w"> </span><span class="kn">import</span> <span class="n">imread</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="s2">&quot;path/to/mask.tif&quot;</span><span class="p">)</span>
<span class="n">cpiv</span><span class="o">.</span><span class="n">update_mask</span><span class="p">(</span><span class="n">mask</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Edit</p>
<ul class="simple">
<li><p>Jan 13, 2023 – Add <code class="xref py py-func docutils literal notranslate"><span class="pre">update_mask()</span></code>. The idea is that the original mask may include regions where image quality is bad, e.g. the bottom shadow region of droplet xz images. In this case, we usually realize the problem after performing the PIV. And to refine the PIV data, we want to update the mask to make it more conservative (i.e. mask out the bad quality region). Therefore, a method is needed to update the “mask” entry in a compact_PIV object.</p></li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="myimagelib.compact_PIV.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#myimagelib.compact_PIV.__init__" title="Link to this definition"></a></dt>
<dd><p>Initialize compact_PIV object from data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> – can be dict or pandas.DataFrame. If it’s dict, set the value directly to self.data. If it’s DataFrame, construct a dict from the DataFrame (filelist).</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#myimagelib.compact_PIV.__init__" title="myimagelib.compact_PIV.__init__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code></a>(data)</p></td>
<td><p>Initialize compact_PIV object from data.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_frame</span></code>(i[, by])</p></td>
<td><p>Get PIV data [x, y, u, v] for a specific frame.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_labels</span></code>()</p></td>
<td><p>Returns filenames originally used for constructing this data.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_csv</span></code>(folder)</p></td>
<td><p>Save as .csv files to given folder.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_mat</span></code>(fname)</p></td>
<td><p>Save the compact_PIV data to a .mat file.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">update_mask</span></code>(mask_img)</p></td>
<td><p>Update mask in the compact_PIV object.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022-2025, Zhengyang Liu.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>